COPY    START  0
FIRST	STL	RETADR	
CLOOP	JSUB	RDREC
	LDA 	#LENGTH
	COMP	#0
	JEQ	ENDFIL
	J	CLOOP
ENDFIL	LDA	=C'EOF'
	LTORG
	STA	BUFFER
	LDA	#3
	STA	LENGTH
	JSUB	WRREC
	J	@RETADR
	USE 	CDATA
RETADR	RESW	1
LENGTH	EQU	4028
	USE	CBLKS
BUFFER	RESB	4096
.
. SUBROUTINE TO READ RECORD IN BUFFER
.
	USE
RDREC	CLEAR	X
	CLEAR	A
	CLEAR	S
	+LDT	#MAXLEN	
RLOOP	TD	INPUT
	JEQ	RLOOP	
	RD	INPUT
	COMPR	A,S
	JEQ	EXIT
	STCH	BUFFER,X
	TIXR	T
	JLT	RLOOP
EXIT	STX	LENGTH
	RSUB
	USE	CDATA
INPUT	BYTE	X'F1'
.
. SUBROUTINE TO READ RECORD FROM BUFFER
.
	USE
WRREC	CLEAR	X
WLOOP	TD 	=X'05'
	LDT 	LENGTH
	WD	=X'02'
	LDCH	BUFFER,X
	TIXR	T
	JLT	WLOOP	
	RSUB
	USE	CADTA
	END 	FIRST